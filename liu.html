<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æŸ³æµªé—»èºÂ·çŸ¥è¯†é—®ç­”+æŸ³éŸµè®°å¿†ç¿»ç‰Œ</title>
    <!-- å¼•å…¥Tailwindå’Œå­—ä½“å›¾æ ‡ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        // Tailwindè‡ªå®šä¹‰é…ç½®
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        willow: '#7da673',
                        willow-deep: '#5a8a4f',
                        willow-light: '#b8d6b1',
                        warbler: '#e8c86a',
                        ink: '#2a3328',
                    },
                    fontFamily: {
                        kai: ['"KaiTi"', '"STKaiti"', 'serif'],
                        song: ['"SimSun"', '"STSong"', 'serif'],
                    },
                    keyframes: {
                        fade-in: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        },
                        flip: {
                            '0%': { transform: 'rotateY(0deg)' },
                            '50%': { transform: 'rotateY(90deg)' },
                            '100%': { transform: 'rotateY(0deg)' },
                        },
                        success-pop: {
                            '0%': { opacity: 0, transform: 'scale(0.8)' },
                            '70%': { transform: 'scale(1.1)' },
                            '100%': { opacity: 1, transform: 'scale(1)' },
                        }
                    },
                    animation: {
                        'fade-in': 'fade-in 1s ease-out forwards',
                        'flip': 'flip 0.6s ease-in-out forwards',
                        'success-pop': 'success-pop 0.6s ease-out forwards',
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            /* å›½é£åŸºç¡€æ ·å¼ */
            .chinese-border {
                border: 1px solid #7da673;
                border-radius: 6px;
                position: relative;
            }
            .chinese-border::before {
                content: '';
                position: absolute;
                top: 6px;
                left: 6px;
                right: 6px;
                bottom: 6px;
                border: 1px dashed #e8c86a;
                border-radius: 4px;
                pointer-events: none;
            }
            
            /* é¦–é¡µèƒŒæ™¯ */
            .home-container {
                background: linear-gradient(to bottom, rgba(248,250,246,0.2), rgba(248,250,246,0.9)), 
                            url('https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/6f5ef69b71fb4b3ba52852feaf4873d7.jpg~tplv-a9rns2rl98-24:720:720.image?rcl=2026010122132800B1AFB2D2E870A34FE4&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1767881609&x-signature=Z9DROqMbuXwJOPt7qvcritytsno%3D');
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
            }
            
            /* åŠŸèƒ½å¡ç‰‡æ ·å¼ */
            .menu-card {
                background: rgba(248,250,246,0.85);
                backdrop-filter: blur(8px);
                transition: all 0.4s ease;
                border: 1px solid rgba(125,166,115,0.4);
                border-radius: 12px;
                overflow: hidden;
                position: relative;
            }
            .menu-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
                transition: left 0.8s ease;
            }
            .menu-card:hover {
                transform: translateY(-8px) scale(1.02);
                box-shadow: 0 12px 24px rgba(90,138,79,0.2);
            }
            .menu-card:hover::before {
                left: 100%;
            }
            
            /* çŸ¥è¯†é—®ç­”æ¨¡å—æ ·å¼ */
            .quiz-container {
                background: linear-gradient(to bottom, rgba(248,250,246,0.2), rgba(248,250,246,0.9)), 
                            url('https://p3-flow-imagex-download-sign.byteimg.com/tos-cn-i-a9rns2rl98/16b09e3968e94de09e7825a03b7f814f.jpg~tplv-a9rns2rl98-24:720:720.image?rcl=2026010122132800B1AFB2D2E870A34FE4&rk3s=8e244e95&rrcfp=8a172a1a&x-expires=1767881609&x-signature=yFcnpyqw3UgKBLvZXQl%2FQ5FY1No%3D');
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
                padding: 20px 0;
                display: none; /* åˆå§‹éšè— */
            }
            .quiz-card {
                background: rgba(248,250,246,0.95);
                border-radius: 12px;
                box-shadow: 0 8px 24px rgba(0,0,0,0.15);
                border: 1px solid #7da673;
                position: relative;
                overflow: hidden;
                width: 90%;
                max-width: 400px;
                margin: 0 auto;
            }
            .quiz-option {
                transition: all 0.3s ease;
                border: 1px solid #d8e6d8;
                border-radius: 8px;
            }
            .quiz-option:hover {
                background: rgba(125,166,115,0.1);
                border-color: #7da673;
                transform: translateX(4px);
            }
            .quiz-option.correct {
                background: rgba(72,187,120,0.2);
                border-color: #48bb78;
            }
            .quiz-option.wrong {
                background: rgba(220,38,38,0.2);
                border-color: #dc2626;
            }

            /* æŸ³éŸµè®°å¿†ç¿»ç‰Œæ¸¸æˆæ ·å¼ */
            .memory-container {
                background: linear-gradient(to bottom, #f8faf6, #e6f0e8);
                width: 100vw;
                height: 100vh;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 20px;
                display: none; /* åˆå§‹éšè— */
            }
            .memory-header {
                text-align: center;
                margin-bottom: 20px;
            }
            .memory-board {
                display: grid;
                grid-template-columns: repeat(5, 1fr); /* è°ƒæ•´ä¸º5åˆ—é€‚é…10å¼ å¡ç‰‡ */
                gap: 8px;
                max-width: 400px;
                width: 100%;
                margin: 0 auto;
            }
            .memory-card {
                aspect-ratio: 1/1;
                perspective: 1000px;
                cursor: pointer;
            }
            .memory-card-inner {
                position: relative;
                width: 100%;
                height: 100%;
                transition: transform 0.6s;
                transform-style: preserve-3d;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                border-radius: 8px;
            }
            .memory-card.flipped .memory-card-inner {
                transform: rotateY(180deg);
            }
            .memory-card.matched .memory-card-inner {
                transform: rotateY(180deg);
                opacity: 0.8;
            }
            .memory-card-front, .memory-card-back {
                position: absolute;
                width: 100%;
                height: 100%;
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .memory-card-front {
                background: #7da673;
                color: white;
                font-size: 2rem;
            }
            .memory-card-back {
                background: white;
                transform: rotateY(180deg);
                padding: 4px;
            }
            .memory-card-icon {
                font-size: 1.8rem;
                color: #5a8a4f;
            }
            .memory-stats {
                display: flex;
                justify-content: space-between;
                width: 100%;
                max-width: 400px;
                margin-bottom: 15px;
                padding: 8px 12px;
                background: rgba(248,250,246,0.8);
                border-radius: 8px;
                border: 1px solid #b8d6b1;
            }
            .memory-controls {
                margin-top: 20px;
                display: flex;
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            .memory-tip {
                margin-top: 15px;
                font-size: 0.9rem;
                color: #5a8a4f;
                text-align: center;
                max-width: 400px;
            }
            .memory-success {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(248,250,246,0.98);
                padding: 30px;
                border-radius: 12px;
                border: 2px solid #7da673;
                text-align: center;
                z-index: 100;
                display: none;
                animation: success-pop 0.6s ease-out forwards;
                max-width: 80%;
            }
            .memory-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 99;
                display: none;
            }
            
            /* é€šç”¨æ ·å¼ */
            .chinese-divider {
                height: 2px;
                background: linear-gradient(90deg, transparent, #7da673, transparent);
                width: 70%;
                margin: 0 auto;
            }
            .back-btn {
                background: rgba(248,250,246,0.9);
                border: 1px solid #7da673;
                border-radius: 8px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                padding: 8px 12px;
                font-size: 14px;
                z-index: 20;
                position: absolute;
                top: 10px;
                left: 10px;
                display: none; /* åˆå§‹éšè—è¿”å›æŒ‰é’® */
            }
            .back-btn:hover {
                background: white;
                transform: scale(1.05);
                box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            }
            .action-btn {
                background: #f8faf6;
                border: 1px solid #7da673;
                color: #2a3328;
                border-radius: 8px;
                padding: 8px 16px;
                font-family: 'KaiTi', 'STKaiti', serif;
                font-size: 14px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }
            .action-btn:hover {
                background: #e8f0e6;
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            }
            .action-btn.primary {
                background: #7da673;
                color: white;
                border-color: #5a8a4f;
            }
            .action-btn.primary:hover {
                background: #5a8a4f;
            }
        }
    </style>
</head>
<body class="font-kai text-ink min-h-screen overflow-x-hidden">
    <!-- é¦–é¡µ -->
    <div id="startScreen" class="fixed inset-0 home-container flex flex-col items-center justify-start p-4 pt-10 pb-16 z-50">
        <!-- åŠŸèƒ½æŒ‰é’®åŒº -->
        <div class="w-full max-w-md flex flex-col gap-8 relative z-10 mb-16 px-4">
            <!-- çŸ¥è¯†é—®ç­”å¡ç‰‡ -->
            <div id="quizBtn" class="menu-card py-10 px-6 cursor-pointer animate-fade-in" style="animation-delay: 0.5s">
                <div class="flex items-center justify-center gap-4">
                    <i class="fa fa-book text-[clamp(2rem,7vw,3rem)] text-willow-deep"></i>
                    <div>
                        <h3 class="text-[clamp(1.2rem,5vw,1.5rem)] font-bold text-ink">æŸ³æµªçŸ¥è¯†é—®ç­”</h3>
                        <p class="text-sm text-gray-600 mt-1">è§£é”æŸ³æµªé—»èºçš„è¶£å‘³å°çŸ¥è¯†</p>
                    </div>
                </div>
            </div>

            <!-- æŸ³éŸµè®°å¿†ç¿»ç‰Œå¡ç‰‡ -->
            <div id="memoryBtn" class="menu-card py-10 px-6 cursor-pointer animate-fade-in" style="animation-delay: 0.8s">
                <div class="flex items-center justify-center gap-4">
                    <i class="fa fa-refresh text-[clamp(2rem,7vw,3rem)] text-warbler"></i>
                    <div>
                        <h3 class="text-[clamp(1.2rem,5vw,1.5rem)] font-bold text-ink">æŸ³éŸµè®°å¿†ç¿»ç‰Œ</h3>
                        <p class="text-sm text-gray-600 mt-1">è®°ä½æŸ³æµªå…ƒç´ ï¼Œé…å¯¹ç›¸åŒå›¾æ¡ˆ</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨ç®€ä»‹ -->
        <div class="absolute bottom-6 w-full max-w-lg chinese-border p-4 bg-sky/70 rounded-lg relative z-10 animate-fade-in px-4" style="animation-delay: 1s">
            <h4 class="text-center font-bold text-willow-deep mb-3 text-base">æŸ³æµªé—»èº Â· æ™¯ç‚¹ç®€ä»‹</h4>
            <p class="text-[clamp(0.8rem,3vw,0.9rem)] leading-relaxed font-song text-ink text-center">
                æŸ³æµªé—»èºæ˜¯è¥¿æ¹–åæ™¯ä¹‹äº”ï¼Œä½äºè¥¿æ¹–ä¸œå—å²¸ï¼Œä»¥é’ç¿ æŸ³è‰²å’Œå©‰è½¬èºé¸£é—»åã€‚
                æ˜¥æ—¥æŸ³ä¸é£˜æ‹‚ï¼Œé»„èºå•¼é¸£ï¼Œå½¢æˆ"æŸ³æµªé—»èº"çš„è¯—æ„æ™¯è§‚ï¼Œæ˜¯è¥¿æ¹–æœ€å…·ç”Ÿæœºçš„æ™¯è‡´ä¹‹ä¸€ã€‚
            </p>
        </div>
    </div>

    <!-- æ¸¸æˆä¸»å®¹å™¨ -->
    <div id="gameContainer" class="fixed inset-0 z-40">
        <!-- è¿”å›æŒ‰é’® -->
        <button id="backBtn" class="back-btn px-4 py-2 z-20 text-ink hover:bg-white text-sm">
            <i class="fa fa-arrow-left mr-1"></i> è¿”å›é¦–é¡µ
        </button>

        <!-- çŸ¥è¯†é—®ç­”æ¨¡å— -->
        <div id="quizModule" class="quiz-container w-full h-full flex items-center justify-center p-4">
            <div class="quiz-card p-6 w-full max-w-md relative">
                <h2 class="text-[clamp(1.2rem,4vw,1.8rem)] text-center text-willow-deep mb-6 font-bold">
                    ã€ŒæŸ³æµªçŸ¥å¤šå°‘ã€
                </h2>
                <div class="chinese-divider mb-8"></div>
                
                <div id="quizQuestion" class="mb-8 text-[clamp(0.9rem,3vw,1.1rem)] leading-relaxed font-song text-ink text-center">
                    1. æŸ³æµªé—»èºæ˜¯â€œè¥¿æ¹–åæ™¯â€ä¸­çš„ç¬¬å‡ ä¸ªæ™¯ï¼Ÿ
                </div>
                
                <div id="quizOptions" class="space-y-4 mb-8">
                    <!-- é€‰é¡¹ä¼šåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div id="quizResult" class="mt-4 text-center text-base hidden"></div>
                
                <div id="quizNext" class="mt-8 text-center hidden">
                    <button onclick="nextQuestion()" class="action-btn primary">
                        ä¸‹ä¸€é¢˜ <i class="fa fa-arrow-right ml-1"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- æŸ³éŸµè®°å¿†ç¿»ç‰Œæ¸¸æˆæ¨¡å— -->
        <div id="memoryModule" class="memory-container">
            <div class="memory-header">
                <h2 class="text-[clamp(1.5rem,5vw,2rem)] text-willow-deep font-bold">ã€ŒæŸ³éŸµè®°å¿†ç¿»ç‰Œã€</h2>
                <p class="text-sm text-gray-600 mt-2">è®°ä½æŸ³æµªå…ƒç´ å›¾æ¡ˆï¼Œæ‰¾å‡ºæ‰€æœ‰é…å¯¹</p>
            </div>
            
            <!-- æ¸¸æˆç»Ÿè®¡ - ä¿®æ”¹é…å¯¹æ•°é‡æ˜¾ç¤º -->
            <div class="memory-stats">
                <div>ç¿»ç‰Œæ¬¡æ•°: <span id="flipCount">0</span></div>
                <div>å·²é…å¯¹: <span id="matchCount">0</span>/5</div>
            </div>
            
            <div class="memory-board" id="memoryBoard"></div>
            
            <div class="memory-controls">
                <button id="restartBtn" class="action-btn">
                    <i class="fa fa-refresh mr-1"></i> é‡æ–°å¼€å§‹
                </button>
                <button id="hintBtn" class="action-btn">
                    <i class="fa fa-lightbulb-o mr-1"></i> æŸ¥çœ‹æç¤º
                </button>
                <button id="easyModeBtn" class="action-btn primary">
                    <i class="fa fa-star mr-1"></i> ç®€å•æ¨¡å¼
                </button>
            </div>
            
            <div class="memory-tip" id="memoryTip">
                æç¤ºï¼šç‚¹å‡»å¡ç‰‡ç¿»é¢ï¼Œæ‰¾åˆ°ç›¸åŒçš„æŸ³æµªå…ƒç´ å›¾æ¡ˆå³å¯é…å¯¹æˆåŠŸ
            </div>
            
            <!-- æˆåŠŸå¼¹çª— -->
            <div class="memory-overlay" id="memoryOverlay"></div>
            <div class="memory-success" id="memorySuccess">
                <h2 class="text-willow-deep text-xl md:text-2xl mb-4">ğŸ‰ æŒ‘æˆ˜æˆåŠŸï¼</h2>
                <p class="mb-4 text-sm md:text-base">ä½ æ€»å…±ç¿»ç‰Œ <span id="finalFlipCount">0</span> æ¬¡</p>
                <p class="mb-6 text-sm md:text-base">çœŸæ˜¯è¿‡ç›®ä¸å¿˜çš„å°èƒ½æ‰‹~</p>
                <button class="action-btn primary" onclick="backToMenu()">è¿”å›é¦–é¡µ</button>
            </div>
        </div>
    </div>

    <script>
        // æŸ³æµªé—»èºé—®ç­”é¢˜åº“
        const quizBank = [
            {
                question: "1. æŸ³æµªé—»èºæ˜¯â€œè¥¿æ¹–åæ™¯â€ä¸­çš„ç¬¬å‡ ä¸ªæ™¯ï¼Ÿ",
                options: ["â‘  ç¬¬å››ä¸ª", "â‘¡ ç¬¬äº”ä¸ª", "â‘¢ ç¬¬å…­ä¸ª"],
                correct: 1,
                tip: "æŸ³æµªé—»èºæ˜¯è¥¿æ¹–åæ™¯ä¹‹äº”å“¦~"
            },
            {
                question: "2. æŸ³æµªé—»èºä½äºè¥¿æ¹–çš„å“ªä¸ªæ–¹ä½ï¼Ÿ",
                options: ["â‘  ä¸œå—å²¸", "â‘¡ è¥¿åŒ—å²¸", "â‘¢ è¥¿å—å²¸"],
                correct: 0,
                tip: "æŸ³æµªé—»èºä½äºè¥¿æ¹–ä¸œå—å²¸çš„å—å±±è·¯~"
            },
            {
                question: "3. æŸ³æµªé—»èºä»¥å“ªç§æŸ³æ ‘æœ€ä¸ºè‘—åï¼Ÿ",
                options: ["â‘  å‚æŸ³", "â‘¡ æ—±æŸ³", "â‘¢ ææŸ³"],
                correct: 0,
                tip: "æŸ³æµªé—»èºä»¥æŸ”ç¾çš„å‚æŸ³ä¸ºç‰¹è‰²ï¼Œå½¢æˆæŸ³æµªæ™¯è§‚~"
            },
            {
                question: "4. æŸ³æµªé—»èºæœ€ä½³è§‚èµæ—¶èŠ‚æ˜¯ï¼Ÿ",
                options: ["â‘  å¤å­£", "â‘¡ ç§‹å­£", "â‘¢ æ˜¥å­£"],
                correct: 2,
                tip: "æ˜¥å­£æ˜¯æŸ³æµªé—»èºæœ€ç¾çš„æ—¶èŠ‚ï¼Œå«©æŸ³æŠ½èŠ½ï¼Œé»„èºå•¼é¸£~"
            },
            {
                question: "5. æŸ³æµªé—»èºæ™¯åŒºå†…çš„ä¸»è¦é¸Ÿç±»æ˜¯ï¼Ÿ",
                options: ["â‘  é»„èº", "â‘¡ ç™½é¹­", "â‘¢ å–œé¹Š"],
                correct: 0,
                tip: "æŸ³æµªé—»èºå› é»„èºçš„å©‰è½¬å•¼é¸£è€Œå¾—å~"
            }
        ];
        
        // å…¨å±€å˜é‡
        let currentQuizIndex = 0;
        // è®°å¿†ç¿»ç‰Œç›¸å…³å˜é‡ - ç§»é™¤å¼‚å¸¸å›¾æ ‡ï¼Œä¿ç•™5ä¸ªæ­£å¸¸æ˜¾ç¤ºçš„å›¾æ ‡
        let memoryData = {
            icons: [
                "fa-leaf", "fa-bird", "fa-tree", "fa-tint", "fa-sun-o" // ä»…ä¿ç•™5ä¸ªæ­£å¸¸æ˜¾ç¤ºçš„å›¾æ ‡
            ],
            cards: [],
            flippedCards: [],
            matchedPairs: 0,
            flipCount: 0,
            isProcessing: false,
            easyMode: false
        };
        
        // ========== çŸ¥è¯†é—®ç­”é€»è¾‘ ==========
        function initQuiz() {
            currentQuizIndex = 0;
            renderQuiz();
        }

        function renderQuiz() {
            const quiz = quizBank[currentQuizIndex];
            document.getElementById('quizQuestion').textContent = quiz.question;
            
            const optionsEl = document.getElementById('quizOptions');
            optionsEl.innerHTML = '';
            
            quiz.options.forEach((option, idx) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option p-4 cursor-pointer text-center text-sm';
                optionDiv.textContent = option;
                optionDiv.onclick = () => checkAnswer(idx);
                optionsEl.appendChild(optionDiv);
            });
            
            document.getElementById('quizResult').classList.add('hidden');
            document.getElementById('quizNext').classList.add('hidden');
        }

        function checkAnswer(choice) {
            const quiz = quizBank[currentQuizIndex];
            const resultEl = document.getElementById('quizResult');
            const options = document.querySelectorAll('.quiz-option');
            
            // æ ‡è®°ç­”æ¡ˆçŠ¶æ€
            options.forEach((el, idx) => {
                el.style.pointerEvents = 'none';
                if (idx === quiz.correct) {
                    el.classList.add('correct');
                } else if (idx === choice && idx !== quiz.correct) {
                    el.classList.add('wrong');
                }
            });
            
            // æ˜¾ç¤ºç»“æœ
            if (choice !== quiz.correct) {
                resultEl.textContent = `âŒ å›ç­”é”™è¯¯~ ${quiz.tip}`;
                resultEl.className = "mt-4 text-center text-base text-red-600";
            } else {
                resultEl.textContent = `âœ… å›ç­”æ­£ç¡®ï¼${quiz.tip}`;
                resultEl.className = "mt-4 text-center text-base text-green-600";
            }
            
            resultEl.classList.remove('hidden');
            
            // æ˜¾ç¤ºä¸‹ä¸€é¢˜æŒ‰é’®ï¼ˆæœ€åä¸€é¢˜é™¤å¤–ï¼‰
            if (currentQuizIndex < quizBank.length - 1) {
                setTimeout(() => {
                    document.getElementById('quizNext').classList.remove('hidden');
                }, 800);
            } else {
                resultEl.textContent = "ğŸ‰ æ‰€æœ‰é—®é¢˜å›ç­”æ­£ç¡®ï¼ä½ å·²è§£é”æŸ³æµªé—»èºå…¨éƒ¨å°çŸ¥è¯†~";
            }
        }

        function nextQuestion() {
            currentQuizIndex++;
            renderQuiz();
        }
        
        // ========== æŸ³éŸµè®°å¿†ç¿»ç‰Œæ¸¸æˆé€»è¾‘ ==========
        // åˆå§‹åŒ–ç¿»ç‰Œæ¸¸æˆ
        function initMemoryGame() {
            // é‡ç½®æ¸¸æˆæ•°æ®
            memoryData = {
                icons: ["fa-leaf", "fa-bird", "fa-tree", "fa-tint", "fa-sun-o"],
                cards: [],
                flippedCards: [],
                matchedPairs: 0,
                flipCount: 0,
                isProcessing: false,
                easyMode: memoryData.easyMode
            };
            
            // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
            document.getElementById('flipCount').textContent = '0';
            document.getElementById('matchCount').textContent = '0';
            
            // åˆ›å»ºå¡ç‰‡æ•°ç»„ï¼ˆæ¯ä¸ªå›¾æ ‡ä¸¤ä»½ï¼‰
            memoryData.cards = [...memoryData.icons, ...memoryData.icons];
            
            // æ‰“ä¹±å¡ç‰‡
            shuffleCards();
            
            // æ¸²æŸ“æ¸¸æˆé¢æ¿
            renderMemoryBoard();
            
            // éšè—æˆåŠŸå¼¹çª—
            document.getElementById('memorySuccess').style.display = 'none';
            document.getElementById('memoryOverlay').style.display = 'none';
        }
        
        // æ‰“ä¹±å¡ç‰‡ï¼ˆFisher-Yates æ´—ç‰Œç®—æ³•ï¼‰
        function shuffleCards() {
            for (let i = memoryData.cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [memoryData.cards[i], memoryData.cards[j]] = [memoryData.cards[j], memoryData.cards[i]];
            }
        }
        
        // æ¸²æŸ“ç¿»ç‰Œé¢æ¿
        function renderMemoryBoard() {
            const board = document.getElementById('memoryBoard');
            board.innerHTML = '';
            
            memoryData.cards.forEach((icon, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.dataset.icon = icon;
                
                card.innerHTML = `
                    <div class="memory-card-inner">
                        <div class="memory-card-front">
                            <i class="fa fa-pagelines"></i>
                        </div>
                        <div class="memory-card-back">
                            <i class="fa ${icon} memory-card-icon"></i>
                        </div>
                    </div>
                `;
                
                // ç»‘å®šç‚¹å‡»äº‹ä»¶
                card.addEventListener('click', () => flipCard(card));
                
                board.appendChild(card);
            });
        }
        
        // ç¿»ç‰Œé€»è¾‘
        function flipCard(card) {
            // é˜²æ­¢å¿«é€Ÿç‚¹å‡»ã€å·²é…å¯¹ã€å·²ç¿»é¢çš„å¡ç‰‡è¢«ç‚¹å‡»
            if (memoryData.isProcessing || 
                card.classList.contains('flipped') || 
                card.classList.contains('matched')) {
                return;
            }
            
            // ç¿»è½¬å¡ç‰‡
            card.classList.add('flipped');
            memoryData.flipCount++;
            document.getElementById('flipCount').textContent = memoryData.flipCount;
            
            // è®°å½•ç¿»é¢çš„å¡ç‰‡
            memoryData.flippedCards.push(card);
            
            // å¦‚æœç¿»äº†ä¸¤å¼ å¡ç‰‡ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é…
            if (memoryData.flippedCards.length === 2) {
                memoryData.isProcessing = true;
                
                const card1 = memoryData.flippedCards[0];
                const card2 = memoryData.flippedCards[1];
                
                // æ£€æŸ¥æ˜¯å¦åŒ¹é…
                if (card1.dataset.icon === card2.dataset.icon) {
                    // åŒ¹é…æˆåŠŸ
                    setTimeout(() => {
                        card1.classList.add('matched');
                        card2.classList.add('matched');
                        memoryData.matchedPairs++;
                        document.getElementById('matchCount').textContent = memoryData.matchedPairs;
                        
                        // é‡ç½®ç¿»é¢æ•°ç»„
                        memoryData.flippedCards = [];
                        memoryData.isProcessing = false;
                        
                        // æ£€æŸ¥æ¸¸æˆæ˜¯å¦å®Œæˆï¼ˆæ”¹ä¸º5å¯¹ï¼‰
                        if (memoryData.matchedPairs === memoryData.icons.length) {
                            setTimeout(() => {
                                document.getElementById('finalFlipCount').textContent = memoryData.flipCount;
                                document.getElementById('memorySuccess').style.display = 'block';
                                document.getElementById('memoryOverlay').style.display = 'block';
                            }, 500);
                        }
                    }, 600);
                } else {
                    // åŒ¹é…å¤±è´¥ï¼Œç¿»å›å»
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        memoryData.flippedCards = [];
                        memoryData.isProcessing = false;
                    }, 1000);
                }
            }
            
            // ç®€å•æ¨¡å¼ï¼šæ˜¾ç¤ºæ‰€æœ‰å¡ç‰‡2ç§’
            if (memoryData.easyMode && memoryData.flipCount === 1) {
                const allCards = document.querySelectorAll('.memory-card');
                allCards.forEach(c => c.classList.add('flipped'));
                
                setTimeout(() => {
                    allCards.forEach(c => {
                        if (!c.classList.contains('matched')) {
                            c.classList.remove('flipped');
                        }
                    });
                }, 2000);
            }
        }
        
        // åˆ‡æ¢ç®€å•æ¨¡å¼
        function toggleEasyMode() {
            memoryData.easyMode = !memoryData.easyMode;
            const btn = document.getElementById('easyModeBtn');
            
            if (memoryData.easyMode) {
                btn.innerHTML = '<i class="fa fa-star mr-1"></i> ç®€å•æ¨¡å¼(å¼€å¯)';
                btn.classList.add('bg-willow-deep');
                alert('ç®€å•æ¨¡å¼å·²å¼€å¯ï¼æ¸¸æˆå¼€å§‹æ—¶æ‰€æœ‰å¡ç‰‡ä¼šæ˜¾ç¤º2ç§’');
            } else {
                btn.innerHTML = '<i class="fa fa-star mr-1"></i> ç®€å•æ¨¡å¼';
                btn.classList.remove('bg-willow-deep');
            }
            
            initMemoryGame();
        }
        
        // æç¤ºåŠŸèƒ½
        function showHint() {
            if (memoryData.isProcessing) return;
            
            // æ‰¾åˆ°ä¸€å¯¹æœªåŒ¹é…çš„ç›¸åŒå¡ç‰‡å¹¶çŸ­æš‚æ˜¾ç¤º
            const unmatchedCards = document.querySelectorAll('.memory-card:not(.matched):not(.flipped)');
            const iconMap = {};
            
            // æ”¶é›†æœªåŒ¹é…çš„å¡ç‰‡å›¾æ ‡
            unmatchedCards.forEach(card => {
                const icon = card.dataset.icon;
                if (!iconMap[icon]) {
                    iconMap[icon] = [];
                }
                iconMap[icon].push(card);
            });
            
            // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰é…å¯¹çš„å›¾æ ‡
            let hintCards = null;
            for (const icon in iconMap) {
                if (iconMap[icon].length >= 2) {
                    hintCards = iconMap[icon];
                    break;
                }
            }
            
            if (hintCards) {
                // çŸ­æš‚æ˜¾ç¤ºæç¤º
                hintCards[0].classList.add('flipped');
                hintCards[1].classList.add('flipped');
                
                setTimeout(() => {
                    if (!hintCards[0].classList.contains('matched')) {
                        hintCards[0].classList.remove('flipped');
                    }
                    if (!hintCards[1].classList.contains('matched')) {
                        hintCards[1].classList.remove('flipped');
                    }
                }, 1500);
            } else {
                alert('å·²ç»æ²¡æœ‰å¯æç¤ºçš„å¡ç‰‡å•¦ï¼');
            }
        }
        
        // ========== æ ¸å¿ƒé€»è¾‘ï¼šç•Œé¢åˆ‡æ¢ ==========
        function backToMenu() {
            // éšè—æ‰€æœ‰æ¸¸æˆæ¨¡å—
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('quizModule').style.display = 'none';
            document.getElementById('memoryModule').style.display = 'none';
            document.getElementById('backBtn').style.display = 'none';
            // æ˜¾ç¤ºé¦–é¡µ
            document.getElementById('startScreen').style.display = 'flex';
        }

        // é¡µé¢åŠ è½½å®Œæˆç»‘å®šäº‹ä»¶
        window.onload = function() {
            // åˆå§‹éšè—æ¸¸æˆå®¹å™¨
            document.getElementById('gameContainer').style.display = 'none';
            
            // æ‰“å¼€çŸ¥è¯†é—®ç­”
            document.getElementById('quizBtn').addEventListener('click', () => {
                document.getElementById('startScreen').style.display = 'none';
                document.getElementById('gameContainer').style.display = 'block';
                document.getElementById('quizModule').style.display = 'flex';
                document.getElementById('memoryModule').style.display = 'none';
                document.getElementById('backBtn').style.display = 'block';
                initQuiz();
            });

            // æ‰“å¼€è®°å¿†ç¿»ç‰Œæ¸¸æˆ
            document.getElementById('memoryBtn').addEventListener('click', () => {
                document.getElementById('startScreen').style.display = 'none';
                document.getElementById('gameContainer').style.display = 'block';
                document.getElementById('quizModule').style.display = 'none';
                document.getElementById('memoryModule').style.display = 'flex';
                document.getElementById('backBtn').style.display = 'block';
                initMemoryGame();
            });

            // ç»‘å®šè¿”å›æŒ‰é’®
            document.getElementById('backBtn').addEventListener('click', backToMenu);
            
            // ç»‘å®šç¿»ç‰Œæ¸¸æˆæŒ‰é’®
            document.getElementById('restartBtn').addEventListener('click', initMemoryGame);
            document.getElementById('hintBtn').addEventListener('click', showHint);
            document.getElementById('easyModeBtn').addEventListener('click', toggleEasyMode);
        }
    </script>
</body>
</html>